# はじめに: 機械学習モデル開発プロジェクトの進め方

## ハンズオンの概要

本ハンズオンを通じ、機械学習モデルがビジネス価値に貢献するよう開発する方法を学ぶことができます。機械学習モデルの要件確認から運用監視までを10のプロセスで定義し、そのうち「開発」にあたる6つのプロセスを本教材の対象としています。次の図では、既存のソフトウェア開発プロセスをDevOpsとし、機械学習モデルの開発プロセスをMLOpsとし上下に分けて示しています。本教材の対象は、図のオレンジの枠で囲った箇所です。

![introduction_001](./images/introduction_001.PNG)

| 英語名                 | 日本語名     | なにをするのか                             |
|------------------------|--------------|---------------------------------------|
| Business Understanding | ビジネス理解 | プロダクトの顧客が理解できる言葉で、機械学習後の価値を定義する。機械学習による価値を計算式で記述する。 |
| Analyze                | データ分析   | 今あるデータの質・量がBusiness Understandingで決めた価値を実現するのに十分か診断する。                       |
| Prepare                | データ準備   | Analyzeの診断結果に基づき、データの質・量を充足させる。   |
| Preprocess             | 前処理       | Prepareで用意したデータを、機械学習モデルが認識しやすいデータに変換する。 |
| Train                  | 学習         | Business Understandingで定めた機械学習の用途と、Preprocessで用意したデータに合わせて機械学習モデルを選択し、学習する。   |
| Test                   | テスト       | Trainで作成したモデルがBusiness Understandingで定義した価値を生むか、モデル、サービス、システムのレベルで確認する。 |

各プロセスの解説は、**なにをするのか**、**なぜやるのか**、**どうやるのか**の3つから構成されます。どうやるのかは、**プログラミング演習**と**コミュニケーション演習**の2つから構成されます。

1. なにをするのか
2. なぜやるのか
3. どうやるのか
   * プログラミング演習
   * コミュニケーション演習

プログラミング演習ではPythonを用いた基本的な機械学習モデルの構築を行います。

* TensorFlowやPyTorchでDeep Learningのモデルを構築する方法は扱っていません。ただDeep Learningでも機械学習モデルの開発プロセスは変わらないためプロジェクトの進め方として参考になると思います。
* 機械学習の理論的な内容は解説していません。実務上より深い知識が求められるようになった場合に備え、各プロセスで参考書籍を記載しています。

コミュニケーション演習では、「プロジェクトで機械学習を担当することになったソフトウェアエンジニア」として、各開発プロセスで他のロールの方とどのようにコミュニケーションをとればよいのかを学びます。

各プロセスの学習時間は10~20分程度です。`README.md`の目次に沿い、自習形式で進めることが可能です。ただ、他のチームメンバーを巻き込んで行うことでより実際の機械学習モデルの開発に近い演習ができます。

学習環境として、メールアドレスのみかつ無料でJupyterLab環境が扱える[Amazon SageMaker Studio Lab](https://studiolab.sagemaker.aws/)を使用しています。アカウントがない場合は、[Request Account](https://bit.ly/3OZJEFv)より作成できます。

## ハンズオンのゴール

**ソフトウェアエンジニア**の方が、プロダクトへの機械学習導入プロジェクトを推進するのに必要最低限のビジネス的、技術的素養を習得することがゴールです。具体的には次の3つのアクションが取れるようになって頂きたいと思います。

1. Pythonで機械学習の基本的な実装を行えるようになる。
2. 開発に関わる他のステークホルダーに、Jupyter Notebookを提示しながら必要な確認をとれるようになる。
3. データサイエンティストに対し適切な声掛けができるようになる。

[2021年のデータサイエンティスト協会のアンケート](https://www.datascientist.or.jp/common/docs/corporate_research2021.pdf)によれば、2021年データサイエンティストを目標通り採用できなかった企業は62%に上り、2019年以降増加傾向です。つまり、プロジェクト開始時にデータサイエンティストの方がいることは稀です。採用できない分は社内の異動でまかなわれています。

ハンズオン学習者はデータサイエンティストに代わり機械学習の実装面を担当するだけでなく、開発に関わるステークホルダーと協調しビジネス価値の在るプロジェクトになるよう働きかけを行うことが期待されます。

## ハンズオンが生まれた理由

機械学習の導入プロジェクトは[80%が失敗する](https://research.aimultiple.com/ai-fail/)といわれています。理由として次の5つが上げられています。注目すべき点は専門職であるデータサイエンティストの不在よりもビジネス目標の不明瞭さやチーム間の連携不足など、組織的な問題が失敗の鍵を握っているということです。

1. **ビジネスの目標がはっきりしていない**
2. データの品質が不十分
3. **プロジェクトのスポンサーが不在**
4. **チーム間の連携が不十分**
5. データサイエンティストなどの専門職の不在

次の図は最初に提示したDevOpsとMLOpsが並走する機械学習導入後のプロダクト開発プロセスに担当するロールをマッピングした図です。全部で18のロールがあります。**プロダクト開発において担当領域の広いソフトウェアエンジニアがビジネス、機械学習の知識を習得することが組織的な問題の解決につながると考え本ハンズオンが生まれました**。

![introduction_002](./images/introduction_002.PNG)

18ロールの中で話したことがないロールの方がいるでしょうか?もしいたら「チーム間の連携が不十分」なサインです。

| 英語名             | 日本語名                   | 役割                                                                 |
|--------------------|----------------------------|----------------------------------------------------------------------|
| Product Manager    | プロダクトマネージャー     | ユーザー体験を向上させるために実装すべきソフトウェア機能を定義する。 |
| Business Analyst   | ビジネスアナリスト         | 解決すべきビジネス上の問題を定義する                                 |
| Data Analyst       | データアナリスト           | データの可視化と分析で問題を定量的に特定する。                       |
| Architect          | アーキテクト               | ソフトウェアアーキテクチャ全体を設計する。                           |
| DevOps Engineer    | DevOpsエンジニア           | ソフトウェアの開発・運用プロセスを自動化する。                       |
| Software Engineer  | ソフトウェアエンジニア     | ソフトウェアの開発を行う。                                           |
| Operator           | 業務担当者                 | ソフトウェアを利用し業務を行う。                                     |
| System Admin       | システム管理者             | サービスの挙動を監視する。                                           |
| IT Auditor         | IT監督者                   | システムや会社全体の権限管理や監査を行う。                           |
| Data architect     | データアーキテクト         | データを管理する基盤を設計、運用する。                               |
| Domain Expert      | 業務有識者                 | 深い業務知識を持ちデータの意味やあるべき状態について定義する。       |
| Data Engineer      | データエンジニア           | 機械学習モデルに入力可能なデータと特徴を作成する。                   |
| Data Scientist     | データサイエンティスト     | 機械学習モデルを開発する。                                           |
| ML Engineer        | 機械学習エンジニア         | 機械学習モデルを本番環境にデプロイ可能な形式に変換する。             |
| ML Operator        | 業務担当者(機械学習側)     | 推論結果に基づき業務を行いつつ、フィードバックを与える。             |
| Model risk Manager | 機械学習モデルリスク管理者 | 機械学習モデルの推論の挙動を監視する。                               |
| MLOps Engineer     | MLOpsエンジニア            | 機械学習モデルの開発・運用プロセスを自動化する。                     |
| AI/ML Architect    | AI/MLアーキテクト          | 機械学習モデル開発に必要なアーキテクチャ全体を設計する。             |

[AI白書2020](https://www.ipa.go.jp/ikc/publish/ai_hakusyo.html)では、アルゴリズムの開発や実装をできる人材より現場の知見と基礎的な機械学習の知識を持ちプロジェクトを推進できる人材が不足していると回答されています。プロダクトマネージャーが機械学習の知識を持つのも必要ですが、技術的素養のあるソフトウェアエンジニアの方が習得が速いでしょう。なにより、最終的にプロダクトに反映されるのはソフトウェアエンジニアであるあなたが理解し実装したプログラムです。

本ハンズオンがプログラミング演習だけでなく、なぜ、なにを、といった根源的な説明やコミュニケーションの演習を含んでいるのは、機械学習の技術を理解するだけでなく18のロールを巻き込みプロジェクトを推進してほしいためです。

AWSはより多くのお客様に、機械学習を活用しプロダクトに蓄積されたデータを顧客体験の改善に直結させ成長を加速していただきたいと考えています。

![introduction_003](./images/introduction_003.PNG)

そのため、ハンズオン資料をGitHubで無料で公開しています。本教材を社内での研修やチームの立ち上げにぜひ役立てていただければと思います。利用したブログ記事など執筆頂けましたら、Issue/Pull Requestでご連絡ください。`README.md`の`Customer Use Cases`に掲載させていただきます。改善点があれば併せてお寄せください。本ハンズオンのコンテンツを皆様の協力を得ながらよりよいものにしたいと考えています。

## Next Step

機械学習モデルの開発を始める前の、環境構築からハンズオンを開始します。

[Environmental Setup](../notebooks/00_environment_setup.ipynb)

## References

1. Takahiro Kubo. [MLOpsのこれまでとこれから](https://speakerdeck.com/icoxfog417/mlopsfalsekoremadetokorekara). 2022.
2. 一般社団法人データサイエンティスト協会. [データサイエンティストの採用に関するアンケート](https://www.datascientist.or.jp/common/docs/corporate_research2021.pdf). 2022.
3. IPA. [AI白書2020](https://www.ipa.go.jp/ikc/publish/ai_hakusyo.html). 2020.
